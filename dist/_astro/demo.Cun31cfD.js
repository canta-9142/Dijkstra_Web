import{p as P,j as R,U as i}from"./Utils.Dx5o_ao2.js";import{r as h}from"./index.Cd_vQiNd.js";const B=window.P5_CONFIG||{width:211,height:211},{width:j,height:I}=B,y=({containerId:d})=>{const p=h.useRef(null),k=h.useRef(null);return h.useEffect(()=>{const m=o=>{const r=[];let a="placing",c=new i.Heap,l=null,u=null,n=null;const b=[22,23,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,43,49,53,57,61,64,65,66,67,68,69,70,72,74,76,77,78,80,82,85,89,91,93,95,101,103,106,108,110,112,113,114,116,118,119,120,122,124,127,129,131,135,139,141,143,148,150,151,152,154,155,156,158,159,160,162,163,164,165,166,169,171,175,181,190,192,194,196,197,198,200,201,202,203,204,205,206,208,211,215,217,219,221,223,225,229,232,233,234,236,237,238,240,242,244,246,248,249,250,255,257,259,261,267,269,271,274,276,278,280,282,283,284,285,286,288,289,290,292,295,299,305,311,313,316,317,318,319,320,322,323,324,325,326,327,328,329,330,332,334,343,345,349,353,358,359,360,361,362,363,364,366,367,368,370,372,374,375,376,379,387,391,393,395,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418];function z(){a!=="done"&&(l.state=i.Node.States.Discovered,l.dist=0,c.push(l),a="search",o.loop())}function E(){let e=c.pop();if(e===null)return!1;let t=Math.floor(e.index/21),s=e.index%21;return e.state===i.Node.States.Visited||e.state===i.Node.States.Blocked?!1:(e.state=i.Node.States.Visited,e===u?!0:(t!=0&&S(e,r[t-1][s],e.dist+1),t!=20&&S(e,r[t+1][s],e.dist+1),s!=0&&S(e,r[t][s-1],e.dist+1),s!=20&&S(e,r[t][s+1],e.dist+1),!1))}function S(e,t,s){t.state===i.Node.States.Visited||t.state===i.Node.States.Blocked||(t.state!==i.Node.States.Discovered?(t.dist=s,t.prev=e,t.state=i.Node.States.Discovered,c.push(t)):c.prioritize(t,s)&&(t.prev=e))}function v(){o.background(10);for(let e=0;e<21;e++)for(let t=0;t<21;t++){const s=r[e][t];if(s===l)o.fill(255,100,0);else if(s===u)o.fill(255,255,0);else switch(s.state){case i.Node.States.Undiscovered:o.fill(50,50,50);break;case i.Node.States.Discovered:o.fill(255,0,0);break;case i.Node.States.Visited:o.fill(0,255,0);break;case i.Node.States.Path:o.fill(0,0,255);break;case i.Node.States.Blocked:o.fill(180,130,80);break}o.rect(t*10+1,e*10+1,9,9)}}o.setup=()=>{o.createCanvas(j,I),r.length=0;for(let e=0;e<21;e++){let t=[];for(let s=0;s<21;s++){let C=new i.Node(e*21+s);t.push(C)}r.push(t)}for(let e of b){let t=Math.floor(e/21),s=e%21;r[t][s]&&(r[t][s].state=i.Node.States.Undiscovered)}l=r[1][1],u=r[19][19],v(),o.noLoop(),o.beginSearch=z},o.draw=()=>{if(v(),a==="search"){if(c.n===0){o.print("何らかのエラーにより、目的地を見つけられませんでした。"),a="done";return}E()&&(a="path",n=u);return}else if(a==="path"){for(;n!=l&&n.prev!==null;)n.prev.state=i.Node.States.Path,n=n.prev;a="done";return}else o.noLoop()}},w=d?document.getElementById(d):p.current;if(!w)return;const f=new P(m,w);k.current=f,window.P5_INSTANCE=f;const g=()=>f.beginSearch(),N=document.getElementById("btn-search");return N?.addEventListener("click",g),()=>{N?.removeEventListener("click",g),f.remove(),delete window.P5_INSTANCE}},[d]),d?null:R.jsx("div",{ref:p})};export{y as default};
